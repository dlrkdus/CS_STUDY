# 서버에 접속한다는 것은 소켓에 정보를 기록한다는 것

소켓을 만든 직후에는 아무것도 기록이 안돼있으므로 송신 의뢰가 와도 통신을 할 수 없다. 

따라서 IP 주소나 Port 번호 같은 통신에 필요한 정보를 프로토콜 스택에 알리는 (접속)동작이 필요하다. 

# 맨 앞부분에 제어 정보를 기록한 헤더를 배치한다

![image](https://github.com/user-attachments/assets/9bbd2314-90e0-4861-bbba-dde23549fd60)


- 통신 동작에서 어떤 정보가 필요한지 검토하는 TCP 프로톨의 사양으로 규정돼있다.
- 송수신/연결끊기/대화 마다 각 단계에서 이 제어 정보 사용
- 패킷마다 헤더에 이 내용이 담겨 있다.

# 접속 동작의 실체

- 애플리케이션이 socket의 connect를 호출한다

```java
connect(<디스크립터>, <서버 IP>, <서버 PORT>)
```

## 접속 동작의 순서 (**3-way handshake**)

![image](https://github.com/user-attachments/assets/a45ffcdb-e738-4528-b946-506d4c0272f7)


1. 클라이언트의 TCP 담당 부분에 IP와 Port 전달 → 서버의 TCP 담당 부분에 전달
    1. 포트번호: 클라이언트 소켓의 수신처가 되는 서버측의 소켓을 지정
2. 포트를 통해 접속 소켓을 지정하고 컨트롤 비트인 `SYN=1` 지정
3. 위와 같이 TCP 헤더 만들고 IP 담당 부분에 건넴 
4. IP 담당 부분이 패킷 송신 실행
5. 네트워크를 통해 **패킷을 서버에 보냄** 
6. 서버측 IP 담당 부분이 TCP 담당 부분에 건네 **헤더 조사**
7. 포트 번호를 찾아서 필요한 정보를 기록하고 상태 변경(접속 동작 진행중) 
8. 응답도 TCP 헤더 만들고 ACK=1 세팅
9. 응답받은 클라이언트는 TCP를 다시 분석하고 SYN=1 확인 후 소켓에 접속 완료 나타내는 제어 정보 기록 
10. 서버에게 응답 받았다는 ACK=1 전송
