# 엔티티

정의 가능한 사물 또는 개념을 의미한다. 
엔티티의 구성 요소는 다음과 같다. 

- **속성**
  - 개체가 갖고 있는 속성이다. 테이블의 각 필드가 속성이다.
- **도메인**
  - 속성의 값, 타입, 제약사항 등을 표현한 것이다.
  - 예를 들어, `VARCHAR(10)`은 타입과 제약사항을 정의해놓은 것이므로 도메인이다.
  - 참고로, 개발에서 말하는 시스템이 해결하고자 하는 비즈니스 문제인 도메인과는 다른 개념이다.

## 엔티티의 관계 

### 식별 관계 (실선)
![image](https://github.com/user-attachments/assets/c8dbe9ae-c641-4db8-a2c1-0cec6a73ddb7)

부모의 PK를 FK로 참조하는 동시에 자신의 PK로 사용하는 관계이다.

### 비식별 관계 (점선)
![image](https://github.com/user-attachments/assets/6e6f8abd-2083-4ff5-bc88-87ef6cbd5d3a)

부모의 PK를 FK로 참조하지만 자신의 일반 속성으로 사용하는 관계이다.

# 정규화

**데이터 중복을 최대한 제거하고, 데이터 무결성을 보장하기 위해 데이터를 구조화된 형태로 조직화**하는 과정을 뜻한다. 

더 자세히 풀어보자.

`결정자` 란, 어떤 속성이 다른 속성을 고유하게 결정할 때, 이 속성을 칭하는 말이다. 주로 PK나 후보키가 결정자가 된다. 

`의존자`란, 결정자에 의해 값이 결정되는 속성을 뜻한다.

`함수적 종속`이란, 결정자와 의존자 간의 관계를 나타낸다. 

즉, A에 의해서 B의 값이 결정될 때, **A를 결정자**, **B를 의존자**라고 하며, **B는 A에 함수적으로 종속된다** 라고 표현한다.

_잘못된 함수적 종속성은 이상 현상(입력/수정/삭제)을 불러일으킨다._

 ## 이상 현상

 - **입력 이상**
  - 불필요하거나 불완전한 데이터를 입력해야 하는 문제.
	- ex) 학생과 수업 정보를 하나의 테이블에 저장하면, 학생이 아직 수업에 등록하지 않았다면 정보를 입력할 수 없음.
  - ```
    (StudentID, Name, Subject)
    (1001, Alice, NULL)  -- 입력 불가
     ```
   
 - **수정 이상**
  - 동일한 정보가 여러 곳에 중복 저장되어 있을 때, 일부만 수정되면 데이터 불일치가 발생.
  - ex) 학생 이름이 여러 레코드에 저장되어 있을 경우, 이름을 변경할 때 모든 레코드를 수정해야 함.
  - ```
    (1001, Alice, Math) 
    (1001, Alice, Science) -- 데이터 불일치
    ```

 - **삭제 이상**
  - 데이터를 삭제할 때 원치 않은 정보까지 함께 삭제되는 문제.
  - ex) 학생이 수업을 취소하면 학생 정보도 같이 삭제됨.
  - ```
    (1001, Alice, Math)
    -- Math 수업 취소 시 Alice 정보도 삭제됨.
    ```

이러한 **이상 현상을 방지하기 위해 잘못된 함수 종속성을 제거하는 것이 정규화**이다.

데이터의 중복 속성을 제거하고 결정자에 의해 동일한 의미의 일반 속성이 하나의 테이블로 집약되므로 **한 테이블의 데이터 용량이 최소화** 되는 효과가 있다.

그러나 정규화가 무조건 성능을 향상 시키는 건 아니다. 

**입력/수정/삭제 시에는 무조건 성능이 향상되지만, 조회 시에는 조건에 따라 성능이 향상될 수도, 저하될 수도 있다.**

## 정규화의 종류

_**모든 정규형은 하위 정규형을 만족해야 한다.**_

| 단계   | 목적                     | 제거 대상                        |
|--------|--------------------------|----------------------------------|
| 1NF    | 데이터를 원자적으로 분리  | 반복 그룹                       |
| 2NF    | 부분 함수 종속 제거       | 기본 키의 일부에만 종속된 속성  |
| 3NF    | 이행적 종속 제거          | 비기본 속성 간의 종속 관계       |
| BCNF   | 결정자가 후보 키가 아닌 경우 제거 | 후보 키가 아닌 결정자         |
| 4NF    | 다치 종속 제거            | 독립적인 다중 값 관계            |
| 5NF    | 조인 종속성 제거          | 비정규 조인                      |
| 6NF    | 모든 종속성을 완전히 분리 | 복합 종속성                     |

<br>

### 제 1 정규형 (1NF: First Normal Form)

- 모든 속성은 원자값을 가져야 한다 (다중 값은 가질 수 없다.)
- 비정규화 테이블
- ```
  StudentID  Name     Subjects
  1          Alice    Math, Science -- 다중 값
  2          Bob      History
  ```
- 1NF 변환
- ```
  StudentID  Name     Subject
  1          Alice    Math
  1          Alice    Science
  2          Bob      History
  ```

### 제 2 정규형 (2NF: Second Normal Form)

- **기본 키의 부분 함수적 종속성**이 없어야 한다.
- 즉, 속성은 기본 키의 일부가 아닌 전체에 종속되어야 한다.
- 1NF 상태
- ```
  CourseID(PK)  StudentID(PK)  CourseName  Instructor
  101           1              Math        Dr. Smith
  101           2              Math        Dr. Smith
  -- CourseName과 Instructor이 StudentID에 종속되지 않는다. (중복 문제)
  ```
- 2NF 변환
- ```
  Course(CourseID, CourseName, Instructor)
  Enrollment(CourseID, StudentID)
  ```

### 제 3 정규형 (3NF: Third Normal Form)

- **이행적 종속**이 없어야 한다.
- 즉, 기본키가 아닌 속성이 다른 속성의 결정자가 되어선 안된다.
- 다른 말로, 일반 속성들끼리 종속관계를 맺어선 안된다.
- 2NF 상태
- ```
  EmployeeID  DeptID  DeptName
  1           D1      HR
  2           D2      IT 
  -- DeptID가 DeptName의 결정자가 되는 상황
  ```
- 3NF 변환
- ```
  Department(DeptID, DeptName)
  Employee(EmployeeID, DeptID)
  ```

### 보이스 코드 정규형 (BCNF (Boyce-Codd Normal Form))

- 모든 결정자가 후보 키여야 한다.
- 즉, 후보 키가 아닌 속성이 결정자가 되어서는 안된다.

### 제 4 정규형 (4NF: Fourth Normal Form)

- 다치 종속이 없어야 한다.

### 제 5 정규형 (5NF: Fifth Normal Form)

- 조인 종속이 없어야 한다.
- 즉, 테이블을 분리한 뒤 다시 조인해도 원본으로 복원될 수 있어야 한다.

### 제 6 정규형 (6NF: Sixth Normal Form)

- 모든 종속성을 분리해 각 테이블이 하나의 관계만 포함하도록 설계한다.














